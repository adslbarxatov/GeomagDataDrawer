# Geomag data drawer v 4.19: руководство пользователя
> **ƒ** &nbsp;Nicolay B. aka RD_AAOW, Соля́ников Я.; 2.01.2022; 14:37

# Содержание
- [Общие сведения о программе](#1-общие-сведения-о-программе)
- [Главный интерфейс программы](#2-главный-интерфейс-программы)
    - [Добавление кривой или объекта на диаграмму](#21-добавление-кривой-или-объекта-на-диаграмму)
    - [Удаление кривых и объектов с диаграммы](#22-удаление-кривых-и-объектов-с-диаграммы)
    - [Скрытие / отображение кривых и объектов](#23-скрытие--отображение-кривых-и-объектов)
    - [Выделение кривых и объектов](#24-выделение-кривых-и-объектов)
    - [Выбор диапазона построения кривой или линии](#25-выбор-диапазона-построения-кривой-или-линии)
    - [Задание расположения и размера изображения кривой или объекта](#26-задание-расположения-и-размера-изображения-кривой-или-объекта)
    - [Настройка подписей изображения кривой](#27-настройка-подписей-изображения-кривой)
    - [Настройка координатных осей изображения кривой](#28-настройка-координатных-осей-изображения-кривой)
    - [Настройка сетки изображения кривой](#29-настройка-сетки-изображения-кривой)
    - [Настройка шрифтов и цветов подписей изображения](#210-настройка-шрифтов-и-цветов-подписей-изображения)
    - [Настройка стиля линии кривой](#211-настройка-стиля-линии-кривой)
- [Меню программы](#3-меню-программы)
    - [«Открыть файл данных»](#311-открыть-файл-данных)
    - [«Загрузить из буфера обмена»](#312-загрузить-из-буфера-обмена)
    - [«Сохранить файл данных»](#313-сохранить-файл-данных)
    - [«Сохранить диаграмму»](#314-сохранить-диаграмму)
    - [«Закрыть диаграмму»](#315-закрыть-диаграмму)
    - [«Сгенерировать кривые»](#316-сгенерировать-кривые)
    - [«Настройки программы»](#317-настройки-программы)
    - [«Выход»](#318-выход)
    - [«Добавить кривую или объект»](#321-добавить-кривую-или-объект)
    - [«Параметрическое добавление кривых»](#322-параметрическое-добавление-кривых)

#

# 1. Общие сведения о программе

***Geomag data drawer*** – программное средство, предназначенное для построения диаграмм на основе табличных данных. Изначально создавался как средство визуализации результатов экспериментальных измерений; может и сейчас быть использован с этой целью.

Geomag data drawer поддерживает следующие форматы представления данных:
- ***Таблицы Microsoft Office Excel '97 и '07*** (```.xls```, ```.xlsx```); поддержка осуществляется с помощью
дополнительного программного обеспечения (см. раздел «Аппаратно-программные требования и комплектация программы»
данного руководства); наличие установленного пакета программ Microsoft Office не требуется; с версии 4.6
в публикуемой сборке поддержка возобновлена;
- ***Табличные данные в формате Windows CSV*** (```.csv```; разделители – точки с запятой);
- В целях расширения возможностей программы добавлена также возможность ***извлечения данных из файлов текстовых форматов***;
- Кроме того, программа имеет свой ***собственный формат хранения данных***, включающий как сами данные диаграммы,
так и её стиль и настройки отображения (файлы данных Geomag data drawer, ```.gdd```).
- Программа может ***генерировать данные диаграммы*** путём прогона заданного числового диапазона через аналитически
заданную функцию. Функция и диапазон построения могут быть указаны пользователем вручную.
- Возможно использование ***текстовых данных из буфера обмена*** для построения диаграмм.

С версии 4.9 доступно также преобразование файлов данных из командной строки, что позволяет выполнять автоматическое (пакетное) преобразование.

В части визуализации и обработки данных Geomag data drawer обеспечивает следующие основные возможности:
- Построение диаграмм по представленным данным;
- Генерация данных для построения кривых по аналитически заданной функции;
- Редактирование данных диаграммы во встроенном редакторе;
- Сохранение файлов данных в формате Windows CSV и формате произвольных табличных данных;
- Настройка большинства графических характеристик диаграмм: размеров, размещения, цветов, шрифтов, линий, маркеров и т.д.;
- Задание собственной координатной плоскости и независимое использование столбцов данных в качестве абсцисс и ординат для каждой исследуемой зависимости;
- Добавление дополнительных графических объектов: текстовых подписей, прямоугольников, эллипсов и линий (доступно с версии 4.4);
- Сохранение диаграмм в графическом формате ```.png``` с возможностью задания достаточно большого выходного размера.
Это позволяет преодолеть ограничения растровой графики при дальнейшем использовании изображения;
- Сохранение диаграмм в векторных форматах ```.svg``` версии 1.1 и ```.emf```, если необходимо избежать потерь при вставке изображения
в печатный документ, или требуется дополнительное редактирование сформированной диаграммы в редакторе векторной графики.

Реализация в качестве отдельного приложения, поддержка всех основных возможностей по редактированию, построению и оформлению диаграмм,
гибкая система управления, двуязычный интерфейс, а также возможность хранения данных в собственном формате снимает необходимость установки
дополнительных программных комплексов. Поэтому ***Geomag data drawer*** можно считать весьма полезным инструментом обработки и визуализации табличных данных.

#

# 2. Главный интерфейс программы

Главное окно приложения представлено на рисунке ниже.

![image002](https://user-images.githubusercontent.com/20893717/147865633-0486bac6-33b0-4e62-b9bc-f5b87afb8b3e.png)

Интерфейс программы адаптирован для работы на планшетных ПК (увеличены элементы окна; добавлена возможность отключения
функции позиционирования диаграмм мышью для исключения конфликтов жестов). Система отрисовки изображения адаптирована
к особенностям ОС Windows 8; обновлена система хранения и обработки данных.

Основные элементы окна:
- Поле отображения диаграммы;
- Поле списка добавленных кривых и объектов (доступен выбор произвольного набора пунктов для одновременной настройки; см. далее);
- Кнопки добавления (![image070](https://user-images.githubusercontent.com/20893717/147865672-b9fc0533-edee-4611-96b8-a61a3bb26f6f.png))
и удаления (![image073](https://user-images.githubusercontent.com/20893717/147865675-f8d2f1b1-41f6-4407-9aaf-340d534c5c2f.png)) кривых
и дополнительных объектов; с версии 4.11 остальные кнопки вынесены в меню;
- Кнопки скрытия / отображения (![image060](https://user-images.githubusercontent.com/20893717/147865701-9568b95b-2f2a-483d-ae25-7203f5fe3e21.png))
и выделения (![image061](https://user-images.githubusercontent.com/20893717/147865708-a2b280f5-5129-4229-9a2c-dc2826726250.png)) кривых и объектов;
с версии 4.11 совмещение кривых и объектов также вынесено в меню;
- Панель параметров диаграммы, позволяющая настраивать собственные параметры отображения выбранных кривых и объектов. А именно:
    - в каком диапазоне абсцисс и ординат следует построить кривую, а также требуется ли транспонирование (вкладка ![image033](https://user-images.githubusercontent.com/20893717/147865745-0a8f1729-373e-4d18-9ea5-78217277d0b7.png));
    - как следует расположить изображение кривой и/или объекта на листе, а также какого оно должно быть размера (вкладка ![image034](https://user-images.githubusercontent.com/20893717/147865768-7e3dc1c0-eeb0-488e-8469-e7c52534fe44.png));
    - требуется ли вручную установить расположение подписей диаграммы и название рисунка, или программа должна установить их автоматически (вкладка ![image036](https://user-images.githubusercontent.com/20893717/147865787-e0805f33-9fb5-45d7-9325-6c8ffc01e84b.png));
    - как следует отображать координатные оси диаграммы (вкладка ![image046](https://user-images.githubusercontent.com/20893717/147865797-31df8b63-1cc6-4918-9616-097ae64dd5bb.png));
    - как следует отображать координатную сетку диаграммы (вкладка ![image047](https://user-images.githubusercontent.com/20893717/147865806-4290b9b5-038b-4d02-a2e9-a2f8d85629b7.png));
    - как следует отображать подписи диаграммы (вкладка ![image048](https://user-images.githubusercontent.com/20893717/147865810-e7c80d5a-e2e9-4bca-a2a6-ba59a3f9b8d8.png));
    - как следует отображать линии кривых диаграммы (вкладка ![image049](https://user-images.githubusercontent.com/20893717/147865821-655cbd1b-faeb-4bdb-bd64-13c9bb091276.png));
- Меню программы (см. раздел «[Меню программы](#3-меню-программы)» данного руководства)).

Главное окно программы в процессе работы представлено на рисунке ниже.

![image004](https://user-images.githubusercontent.com/20893717/147865850-4efc285a-ece6-4768-b432-7734ce790b30.png)

Все изменения, выполняемые пользователем в поле параметров диаграммы, немедленно отражаются на диаграмме применительно к тем кривым
и графическим объектам, которые помечены в списке кривых и объектов и выделены серым цветом в поле диаграммы. Набор редактируемых
кривых и объектов может быть произвольным. Добавление в группу редактируемых выполняется аналогично выделению группы файлов
в Проводнике Windows, т.е. с помощью клавиш ```[Ctrl]``` и ```[Shift]```. Таким образом, пользователь может производить тонкую
настройку параметров быстро и эффективно.

Каждый элемент управления в поле параметров, вкладки, а также пункты меню программы снабжены подсказками; для их вызова достаточно
задержать курсор над любым элементом на две секунды; при отсутствии движения подсказка отображается в течение 30 секунд.

Программа поддерживает функцию операционной системы *«Открыть с помощью»*. В случае успешной загрузки программа сразу приступает
к работе с указанным файлом.

Предусмотрена также возможность *автоматического построения кривых при загрузке файла* (если позволяет его содержимое).
Для этого программа создаёт файл стандартного шаблона ```GeomagDataDrawer.txt``` (если его ещё нет), аналогичный тому, который используется в функции
[параметрического добавления кривых](#322-параметрическое-добавление-кривых). Пользователь может изменять его по своему усмотрению, создавая различные стили предпросмотра.
Это позволяет ускорить поиск нужного файла данных, ориентируясь на изображение диаграммы, а не на её табличное
представление (аналогично просмотру фотографий).

В программе доступна возможность *движения по области построения*. Для этого можно воспользоваться полосами прокрутки, а также мышью.
В последнем случае необходимо щёлкнуть левой кнопкой мыши в любой части области построения и сдвинуть указатель в том направлении,
в котором требуется сдвинуть диаграмму, после чего отпустить кнопку (аналогично движению руки при перемещении большого листа бумаги).

Размер области построения, и, соответственно, размер сохраняемого изображения диаграммы определяется расположением изображений
кривых и объектов; её правый нижний угол совпадает с правым нижним углом крайнего изображения кривой. Соответственно, для увеличения
области построения необходимо переместить это изображение далее вправо и/или вниз.

Наконец, если работа над диаграммой не была завершена, все данные и настройки могут быть сохранены в собственный формат файлов программы,
после чего восстановлены при следующем запуске. Данная функция дублируется *функцией автосохранения (при закрытии) и автовосстановления
(при открытии)* состояния программы.


## 2.1. Добавление кривой или объекта на диаграмму

Чтобы добавить новую кривую или графический объект на диаграмму, необходимо нажать кнопку
![image070](https://user-images.githubusercontent.com/20893717/147865672-b9fc0533-edee-4611-96b8-a61a3bb26f6f.png) рядом со списком кривых
и объектов. С версии 4.11 для этой функции доступна горячая клавиша, см. раздел «[Меню программы](#3-меню-программы)» данного руководства.
При этом будет вызвано окно параметров добавления.

![image020](https://user-images.githubusercontent.com/20893717/147865987-5001624f-7d18-4a1d-bff4-2eac4a29cef7.png)

При добавлении кривой потребуется указать, какой столбец из загруженного файла данных будет столбцом абсцисс, а какой – столбцом ординат.
При добавлении объекта потребуется выбрать его тип (в текущей версии – линия (4 вида), прямоугольник, эллипс или текстовая подпись).
Количество кривых и объектов на диаграмме не должно превосходить максимально допустимое (см. раздел «Ограничения и стандартные значения
параметров» данного руководства).


## 2.2. Удаление кривых и объектов с диаграммы

С помощью кнопки ![image073](https://user-images.githubusercontent.com/20893717/147865675-f8d2f1b1-41f6-4407-9aaf-340d534c5c2f.png) можно
удалить кривые и/или объекты с диаграммы. При этом потребуется подтверждение пользователя. Пользователь может выбрать несколько кривых
и объектов в списке для одновременного удаления. С версии 4.11 для этой функции доступна горячая клавиша; см. раздел 
«[Меню программы](#3-меню-программы)» данного руководства.


## 2.3. Скрытие / отображение кривых и объектов

С помощью кнопки ![image060](https://user-images.githubusercontent.com/20893717/147865701-9568b95b-2f2a-483d-ae25-7203f5fe3e21.png) пользователь
может временно скрывать выделенные кривые и объекты (кнопка при этом будет «отпущена»). При необходимости они могут быть снова отображены
в любой момент (кнопка будет «нажата»).


## 2.4. Выделение кривых и объектов

Кнопка ![image061](https://user-images.githubusercontent.com/20893717/147865708-a2b280f5-5129-4229-9a2c-dc2826726250.png) позволяет выделить кривые
и объекты для настройки с помощью мыши. Для этого необходимо нажать кнопку и в поле построения диаграммы мышью выделить зону, в которой находятся
требуемые кривые и объекты. Все элементы диаграммы, затронутые прямоугольной областью выделения, будут выделены в списке добавленных кривых
и объектов. Кнопка выбора при этом вернётся в неактивное состояние.


## 2.5. Выбор диапазона построения кривой или линии
> *Параметры этой и всех последующих вкладок применяются ко всем кривым, выбранным (выделенным) в списке кривых.
> Часть функций будет недоступна при работе с графическими объектами*

Содержимое вкладки представлено на рисунке ниже.

![image050](https://user-images.githubusercontent.com/20893717/147866150-fa42a4d3-1bae-4269-b9fc-2ee18a236237.png)

Диапазоны построения вычисляются автоматически при загрузке каждой кривой в соответствии с её реальными границами. Причём, границы округляются
до первой слева значащей цифры. Несмотря на это, они могут быть изменены пользователем вручную по своему усмотрению. Из этой вкладки доступно
также транспонирование кривой, т.е. обмен абсцисс с ординатами местами.

Следует отметить, что границы диапазонов не обязаны соблюдать правило «*max ≥ min*». В частности, координатная плоскость может быть «отражена»
по горизонтали, по вертикали или по обоим направлениям сразу. Это можно сделать как вручную, так и с помощью кнопок
![image037](https://user-images.githubusercontent.com/20893717/147866171-34e1412f-b799-487f-bbd2-9e5f3841bada.png) и
![image038](https://user-images.githubusercontent.com/20893717/147866178-eb9d47b0-76f6-4acc-8e47-c26bfa504d96.png), что будет соответствовать
развороту осей абсцисс и ординат, соответственно. При этом опция транспонирования остаётся доступной. Всё это позволяет повысить гибкость
и информативность диаграммы в зависимости от потребностей конкретного исследования.


## 2.6. Задание расположения и размера изображения кривой или объекта

Содержимое вкладки представлено на рисунке ниже.

![image051](https://user-images.githubusercontent.com/20893717/147866262-cff5e3a1-b035-4d3f-994e-d0b9c2e9e26b.png)

Размер изображения отдельной кривой или объекта и его смещение ограничены максимальным размером листа (см. раздел «Ограничения
и стандартные значения параметров» данного руководства). Но благодаря возможности перемещения по области построения и достаточно
большому её размеру программа позволяет строить и размещать требуемым образом большое количество кривых на диаграмме.

С помощью соответствующих кнопок можно расположить выбранные кривые и объекты в ряд или в столбец. При этом программа автоматически
рассчитает соответствующие координаты для выбранных изображений.

В программе также есть возможность задания расположения изображения каждого элемента диаграммы с помощью мыши:
- По *двойному щелчку левой кнопки мыши* на поле диаграммы текущие выбранные изображения смещаются таким образом, что их верхние левые
углы устанавливаются на место щелчка.
- По *двойному щелчку правой кнопки мыши* изображения изменяют размеры так, чтобы их нижние правые углы оказались в месте щелчка.
- При *зажатой клавише* ```[Ctrl]``` *двойной щелчок левой кнопкой мыши* задаёт новое местоположение подписи рисунка.
- *Двойной щелчок правой кнопкой при зажатой клавише* ```[Ctrl]``` устанавливает подписи осей диаграммы таким образом, чтобы они
визуально пересекались в точке, в которой был выполнен щелчок.

Новые значения параметров передаются в соответствующие поля настроек диаграммы. Следовательно, ограничения на данную функцию накладываются
те же, что и на соответствующие поля.

Применительно к графическим объектам поля смещений определяют их расположение на диаграмме, а поля размеров задают величину прямоугольников,
эллипсов и полей отображения линий. Размеры полей для текстовых подписей рассчитываются автоматически.


## 2.7. Настройка подписей изображения кривой

Содержимое вкладки представлено на рисунке ниже.

![image053](https://user-images.githubusercontent.com/20893717/147866380-11bf648a-9c99-430f-86aa-7a8daa944ca8.png)

При выборе *автоматического задания подписей* и их расположения все остальные поля становятся недоступными, а соответствующие параметры
рассчитываются программой автоматически. Подписи осей размещаются рядом с осями внутри координатной плоскости; подписи изображений располагаются
так, чтобы при наложении нескольких кривых они находились в одной строке с пробелами между ними. Сама подпись, равно как и название кривой
в списке берётся либо из файла данных, либо формируется программой путём порядковой нумерации.

При выборе *ручного задания подписей* в поля параметров подставляются значения, вычисленные программой. В дальнейшем они ограничены только
размером изображения кривой. Заметим, что поле подписи диаграммы в этой вкладке применяется только к первой из выделенных кривых, если их выбрано несколько.

Применительно к графическому объекту «Текстовая строка» поле подписи задаёт собственно текст строки. Поведение объекта при этом не зависит
от состояния флажка «Автоопределение».


## 2.8. Настройка координатных осей изображения кривой

Содержимое вкладки представлено на рисунке ниже.

![image054](https://user-images.githubusercontent.com/20893717/147866573-7f501125-ca3e-43c2-a54b-baa6e0e7546a.png)

С помощью соответствующих полей можно настроить число основных и дополнительных делений на осях диаграммы, толщину осей в пикселях, а также их цвет
и относительное расположение, указать формат отображения чисел на шкалах (обычный или экспоненциальный). Возможен выбор автоопределения для числа делений;
в этом случае число засечек выбирается как наиболее подходящее для заданного диапазона построения.

Все параметры (здесь и далее) имеют допустимые диапазоны; ознакомиться с ними можно в разделе «Ограничения и стандартные значения параметров» данного руководства.
Цвет осей настраивается нажатием на цветную кнопку рядом с соответствующей надписью. Кнопка имеет цвет, соответствующий последнему выбранному цвету осей.

Оси могут быть принудительно установлены слева (сверху), по центру (посередине) или снизу (справа), или их расположение может быть определено автоматически.
В последнем случае программа установит ось в пересечение с нулём другой оси или выровняет её по той стороне, к которой ноль окажется ближе.

Кнопка «×» здесь и далее предназначена для отключения отображения того или иного элемента. Это, на самом деле, означает задание для него белого цвета,
который интерпретируется программой как прозрачный и не отображается при перерисовке. Указание белого цвета для осей, сетки и подписей будет иметь тот же эффект.


## 2.9. Настройка сетки изображения кривой

Содержимое вкладки представлено на рисунке ниже.

![image055](https://user-images.githubusercontent.com/20893717/147866639-767b6726-6d5e-4e09-8126-1ca7e2454449.png)

С помощью соответствующих полей можно настроить толщину линий сетки, а также цвета основных и дополнительных линий. Цвета линий сетки по умолчанию
совпадают с фоном (белый), поэтому сетка не видна. При «включении» сетки её линии отстраиваются в соответствии с расположением засечек на осях.
Кнопка «×» или установка белого цвета линий скрывает сетку.


## 2.10. Настройка шрифтов и цветов подписей изображения

Содержимое вкладки представлено на рисунке ниже.

![image056](https://user-images.githubusercontent.com/20893717/147866681-69bf6f30-1ce2-46a2-b3fa-69d893784e4e.png)

Вкладка позволяет настроить стиль отображения подписи изображения и подписей осей кривой или графического объекта «Текстовая строка».
Кнопки выбора шрифтов вызывают стандартное окно выбора шрифта, его кегля и стиля. Цветные кнопки позволяют задать цвета подписей.

![image013](https://user-images.githubusercontent.com/20893717/147866695-566c75c5-877e-4d48-a674-73112e11f8a5.png)

Программа не допускает использование некоторых шрифтов. Если пользователь выбирает неподходящий шрифт, программа извещает его об этом
и предлагает выбрать другой. Установка белого цвета подписей отключает их.


## 2.11. Настройка стиля линии кривой

Содержимое вкладки представлено на рисунке ниже.

![image057](https://user-images.githubusercontent.com/20893717/147866709-00b5c268-efb9-4c5f-8bd7-c485d39503b0.png)

Вкладка позволяет настроить толщину линии кривой или графического объекта «Линия», её цвет и стиль отображения, а также используемый маркер.
Под стилем понимается один из трёх вариантов представления кривой:
- «Только линия» – указывает на отображение линии без маркеров;
- «Линия и маркеры» – указывает на отображение линии с маркерами;
- «Только маркеры» – указывает на отображение только маркеров в опорных точках кривой.

Если стиль предполагает отображение маркеров, поле выбора маркера становится доступным; в противном случае оно блокируется.
Список доступных маркеров состоит из двух частей:
- Стандартные маркеры, формируемые программой. Доступны под номерами 1 (квадратик), 2 (кружочек), 3 (треугольник), 4 (пустой прямоугольник), 5 (кольцо) и 6 (крестик).
- Дополнительные маркеры.

Дополнительные маркеры получаются программой из изображений в формате ```.png```, хранящихся в директории ```Markers```, находящейся в одной
директории с программой. Если данной директории не существует, программа автоматически её создаёт. Если в директории есть изображения в формате ```.png```,
программа загружает в качестве маркеров только те из них, которые доступны, не повреждены и имеют подходящий размер (см. раздел «Ограничения
и стандартные значения параметров» данного руководства). Успешно загруженные маркеры доступны под номерами 7, 8 и далее.

Следует отменить, что программа особым образом преобразует загружаемые изображения. А точнее:
- Белый (```#FFFFFF```) цвет или белый прозрачный цвет (```#00FFFFFF```) заменяется белым прозрачным цветом;
- Все остальные цвета заменяются выбранным цветом кривой.

Эта функция позволяет использовать в качестве маркеров практически любые изображения без особых изменений. В стандартную комплектацию
программы дополнительные маркеры не входят.

#

# 3. Меню программы

Главное меню программы представлено пунктами, описанными ниже. В скобках указаны «горячие клавиши», с помощью которых можно вызвать соответствующее меню.
Выделенные буквы можно использовать для быстрого вызова функции с нажатой клавишей ```[Alt]```.
- `Ф`айл; включает подменю:
    - `О`ткрыть файл данных (```[Ctrl]``` + ```[O]```);
    - Загрузить из б`у`фера обмена (```[Ctrl]``` + ```[V]```);
    - `С`охранить файл данных (```[Ctrl]``` + ```[S]```);
    - Сохранить `д`иаграмму (```[Ctrl]``` + ```[I]```);
    - Закрыт`ь` диаграмму (```[Ctrl]``` + ```[W]```);
    - С`г`енерировать кривые (```[Ctrl]``` + ```[G]```);
    - Настро`й`ки программы (```[Ctrl]``` + ```[P]```);
    - В`ы`ход (```[Ctrl]``` + ```[Q]```).
- Оп`е`рации; включает подменю:
    - Добавить кр`и`вую или объект (```[F5]```);
    - Параметри`ч`еское добавление кривых (```[Ctrl]``` + ```[F5]```);
    - Выбор столб`ц`ов данных кривой (```[F6]```);
    - Со`в`местить кривые или объекты (```[F7]```);
    - Удали`т`ь кривые или объекты (```[F8]```);
    - Реда`к`тировать данные диаграммы (```[Ctrl]``` + ```[E]```);
    - `З`агрузить стиль (```[F11]```);
    - Сохранить сти`л`ь (```[F12]```);
    - С`б`росить стиль (```[F9]```);
    - Сохранить `ш`аблон добавления кривых (```[Ctrl]``` + ```[T]```).
- `П`омощь; включает подменю:
    - Сп`р`авка (```[F1]```);
    - О програ`м`ме (```[F2]```);
    - Выбор языка интерфейса (список).
    - `А`ссоциировать файлы.


## 3.1. «Файл»

## 3.1.1. «Открыть файл данных»

Вызывает стандартное окно открытия файла. Возможность добавления кривых и объектов появляется сразу после подтверждения выбора файла данных,
если он доступен и имеет корректный формат. Если же при загрузке возникла ошибка, пользователь получает соответствующее сообщение, а программа
вновь отображает последнюю успешно загруженную диаграмму.

> ***Все несохранённые данные при этом теряются, если пользователь соглашается с соответствующим предупреждением.***

Если пользователь выбрал файл данных Geomag data drawer (```.gdd```), в котором уже содержались настройки отображения кривых и графических
объектов, в поле диаграммы будет отображено последнее их состояние. Если используется шаблон для автоматического добавления кривых на диаграмму,
при загрузке файла данных они также будут отображены. Во всех остальных случаях работа начинается с пустого поля диаграммы. Но в любом случае файл
должен содержать не менее двух строк и не менее двух столбцов данных.

В программе явно задано максимально допустимое количество столбцов и строк данных (см. раздел «Ограничения и стандартные значения параметров»
данного руководства). Столбцы и строки данных, выходящие за допустимый диапазон, игнорируются при загрузке.

При выборе опции извлечения данных из произвольного файла пользователю потребуется сначала указать предполагаемое количество столбцов данных.

![image022](https://user-images.githubusercontent.com/20893717/147868607-2b928c9a-cf8d-44b8-a344-f3fe21ec2620.png)

Это значение может быть указано «с запасом», если точное число столбцов неизвестно. Все недостающие значения будут заменены нулями. Более
подробные сведения об извлечении данных содержатся в разделе «Спецификации форматов файлов» данного руководства.

При открытии любого файла (кроме ```.gdd```) пользователю также потребуется указать количество строк файла, которое будет использоваться
для поиска имён столбцов данных.

![image080](https://user-images.githubusercontent.com/20893717/147868744-b8245037-1d2a-4808-bac9-113afbf7d3cf.png)

Заданное количество строк будет рассматриваться программой именно как набор текста: данные из этих строк будут проигнорированы. Данное значение
нужно указывать точно, т.к. меньшее значение будет вызывать ошибку (текст окажется там, где должны быть данные), а большее значение приведёт
к потере части данных и некорректному отображению имён столбцов.

Извлечённые из файла данных подписи столбцов данных используются для обозначения и подписывания кривых в программе. Если подписи считать
не удалось (в частности, если количество предполагаемых столбцов при извлечении данных оказалось больше или меньше реального числа столбцов),
программа именует их в порядке считывания: с.1, с.2 и т.д.


## 3.1.2. «Загрузить из буфера обмена»

Пункт меню позволяет использовать текстовые данные в буфере обмена, скопированные из другой программы, для построения диаграммы.
При этом пользователю будет предложено указать ожидаемое количество столбцов и количество строк для поиска имён столбцов.

> ***Все несохранённые данные при этом теряются, если пользователь соглашается с соответствующим предупреждением.***


## 3.1.3. «Сохранить файл данных»

Программа может сохранять загруженные данные в файлы всех типов, которые поддерживает (кроме ```.xls``` и ```.xlsx```). Если сохранение произошло
с ошибкой, пользователь извещается об этом. Названия столбцов данных также могут быть сохранены, если соответствующая опция выбрана в настройках
программы. Следует отметить, что сохранение графических объектов возможно только в собственном формате программы.


## 3.1.4. «Сохранить диаграмму»

Вызывает окно вариантов формирования конечного изображения диаграммы.

![image015](https://user-images.githubusercontent.com/20893717/147868885-7397ad58-6633-4f70-91d3-f680b25846b1.png)

Пользователю предлагаются следующие варианты сохранения:
- *Сохранить видимый макет*. В этом случае изображение сохраняется в том виде и размере, в котором оно отображается в главном окне программы.
При этом можно увеличить масштаб изображения, если необходимо, например, повысить его качество. Ограничения величины масштаба можно найти
в разделе «Ограничения и стандартные значения параметров» данного руководства. Формат файла – ```.png```.
- *Подогнать макет*. Данная группа вариантов позволяет сохранять изображения в пропорциях форматов бумаги A3 и A4. При этом отображаемое
в главном окне изображение располагается в верхнем левом углу будущего листа бумаги, а его размер пересчитывается таким образом, чтобы оно
максимально заполнило лист с учётом его расположения и размера. Незаполненная часть листа остаётся пустой. Заметим, что пересчёт изображения
выполняется в качестве 300 dpi, что обеспечивает приемлемое качество печати на чёрно-белом и цветном принтере. Формат файла – ```.png```.
- *Сохранить как векторное изображение*. Этот вариант позволяет сохранять изображения в векторных форматах ```.svg``` и ```.emf```. Подходит
для выполнения более тонких модификаций изображения диаграммы, а также в других случаях, когда растровое изображение неприемлемо
(например, при позиционировании изображения в тексте печатного документа). Элементы рисунка группируются таким образом, чтобы минимизировать
время, необходимое на ручную коррекцию диаграммы.

Кнопка «Сохранить» вызывает стандартное окно сохранения; кнопка «Отмена» прерывает операцию.


## 3.1.5. «Закрыть диаграмму»

Меню закрывает текущую диаграмму и возвращает программу в начальное состояние. Поля настроек и пункты меню, связанные с сохранением, блокируются.

> ***Все несохранённые данные при этом теряются, если пользователь соглашается с соответствующим предупреждением.***


## 3.1.6. «Сгенерировать кривые»

Вызывает окно, позволяющее задать аналитические функции и диапазон генерации данных.

![image081](https://user-images.githubusercontent.com/20893717/147869357-a560690c-c492-4073-9ceb-a9e2f2b35661.png)

Пользователь может задать функции, табличное представление которых требуется рассчитать, и указать диапазон построения. В случае обнаружения ошибок
при составлении функции пояснительные сообщения отображаются под полем ввода функции. Проверка корректности задания функции выполняется по нажатию
кнопки «+» или клавиши [Enter]; функция при этом добавляется в список проверенных функций. Количество добавляемых кривых ограничено (см. раздел
«Ограничения и стандартные значения параметров» данного руководства). Корректность диапазона проверяется при нажатии кнопки «ОК».

Кнопка «ОК» запускает генерацию и передаёт данные на отрисовку в главное окно программы. После этого становятся доступны все основные функции меню.
Кнопка «Отмена» возвращает программу в исходное состояние.

> ***Все несохранённые данные при этом теряются, если пользователь соглашается с соответствующим предупреждением.***


## 3.1.7. «Настройки программы»

Вызывает окно настроек программы.

![image017](https://user-images.githubusercontent.com/20893717/147869561-82181086-9a87-410a-adff-bcb0d0a326b2.png)

Пользователь может:
- Установить обязательный запрос на завершение работы с программой. Если эта опция отключена, выход из программы может быть произведён,
в том числе – случайным закрытием главного окна, что может привести к потере важных данных (если не установлена следующая опция).
- Включить функцию автоматического восстановления состояния программы. Если она включена, последние загруженные данные и отображаемые кривые будут
восстановлены программой в том же виде при следующем запуске.
- Включить функцию автоматического добавления кривых на диаграмму при загрузке файла данных (см. раздел
[«Главный интерфейс программы»](#2-главный-интерфейс-программы) данного руководства).
- Включить функцию сохранения названий столбцов данных в файлах данных текстовых форматов.
- Отключить функцию позиционирования диаграмм мышью. Рекомендуется при работе на планшетных ПК во избежание конфликтов жестов.

Кнопка «Сохранить» вызывает обновление конфигурации программы; кнопка «Отмена» позволяет покинуть окно настроек без их изменения.


## 3.1.8. «Выход»

Позволяет завершить работу с программой. В зависимости от настроек, завершение работы может сопровождаться сохранением состояния диаграммы и запросом
на выход из приложения. При этом программа сохраняет размеры и положение главного окна; они восстанавливаются при следующем запуске.

> ***Все несохранённые данные при этом теряются, если пользователь соглашается с соответствующим предупреждением.***


## 3.2.1. «Добавить кривую или объект»

Пункт меню выполняет функции, аналогичные описанным в [пункте 2.1](#21-добавление-кривой-или-объекта-на-диаграмму) данного руководства.


## 3.2.2. «Параметрическое добавление кривых»

Если необходимо быстро добавить несколько однотипных диаграмм и также быстро расположить их на листе, можно воспользоваться параметрическим
добавлением кривых. С помощью соответствующего диалогового окна можно задать номера столбцов данных, размеры каждого изображения и его положение,
а также подпись к нему.

![image021](https://user-images.githubusercontent.com/20893717/147869713-de608939-1905-4e37-96d0-aca05e7b1943.png)

Если требуется добавить несколько диаграмм за один раз, можно воспользоваться опцией загрузки параметров из файла. С этой
целью пользователь может создать текстовый документ, строки которого сформированы по правилам, указанным в диалоговом окне, и загрузить его, нажав
кнопку «Файл». Кроме того, файл, подходящий для этой функции, может быть создан с помощью соответствующего пункта меню.

