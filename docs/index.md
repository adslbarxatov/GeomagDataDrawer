# Geomag data drawer: complete user guide
> **ƒ** &nbsp;Nicolay B. aka RD_AAOW, Соля́ников Я.; 23.07.2023; 21:17

# Contents
- [General information](#general-information)
- [Main app interface](#main-app-interface)
    - [Adding a curve or object to a diagram](#section-3)
    - [Remove curves and objects from diagram](#section-4)
    - [Hide/show curves and objects](#section-5)
    - [Select curves and objects](#section-6)
    - [Selecting a range for plotting a curve or line](#section-7)
    - [Setting the location and size of the curve or object image](#section-8)
    - [Curve image captions settings](#section-9)
    - [Setting the coordinate axes of the curve image](#section-10)
    - [Set curve image grid](#section-11)
    - [Customizing fonts and colors of image captions](#section-12)
    - [Set curve line style](#section-13)
- [App menu](#app-menu)
    - File
    - [“Open data file”](#section-16)
    - [“Load from clipboard”](#section-17)
    - [“Save data file”](#section-18)
    - [“Save diagram”](#section-19)
    - [“Close diagram”](#section-20)
    - [“Generate curves”](#section-21)
    - [“Program settings”](#section-22)
    - [“Exit”](#section-23)
- Operations
    - [“Add curve or object"](#section-25)
    - [“Parametric addition of curves"](#section-26)
    - [“Select curve data columns"](#section-27)
    - [“Merge curves or objects"](#section-28)
    - [“Delete curves or objects"](#section-29)
    - [“Edit diagram data"](#section-30)
    - [“Load style"](#section-31)
    - [“Save style"](#section-32)
    - [“Reset style"](#section-33)
    - [“Save curves template"](#section-34)
- Help
    - [“About / Help”](#section-36)
    - [Menu item with interface language selection](#section-37)
    - [“Associate files”](#section-38)
    - Optional
    - [“Join data tables”](#section-40)
    - [“Create vector image”](#section-41)
- [Hardware and software requirements and app contents](#section-42)
    - App contents
    - [Files and directories](#section-44)
    - [Supported data formats](#section-45)
    - [Support for Microsoft Office Excel formats](#microsoft-office-excel)
    - [Requirements for installing the app](#section-46)
    - [Working with the app from the command line](#section-47)
- [Restrictions and default parameter values](#section-48)
- [File format specifications](#section-49)
    - Geomag data drawer files
    - [Microsoft Office Excel data files](#microsoft-office-excel-1)
    - [Data files in Windows CSV format](#windows-csv)
    - [Files to extract data from](#section-50)
- [Download links](https://adslbarxatov.github.io/DPArray#geomag-data-drawer)
- [Русская версия](https://adslbarxatov.github.io/GeomagDataDrawer/ru)

---

# 1. General information

***Geomag data drawer*** is a software tool designed to build diagrams based on tabular data. It was originally
created as a means of visualizing the results of experimental measurements; can still be used for this purpose.

Geomag data drawer supports the following data formats:
- ***Microsoft Office Excel ’97 and ’07 Spreadsheets*** (`.xls`, `.xlsx`). Support is provided through additional software
(see section [“Hardware and software requirements and app contents”](#section-42) of this guide). The presence of the
installed Microsoft Office software package is not required.
- ***Table data in Windows CSV format*** (`.csv`; separators are semicolons).
- In order to expand the capabilities of the app, the ability to ***extract data from files of text formats*** has also been added.
- In addition, the app has its ***own data storage format***, which includes both the diagram data itself,
as well as its style and display settings (Geomag data drawer files, `.gdd`).
- The app can ***generate tabular data*** by running a given numerical range through analytically
given function. The function and plotting range can be manually specified by user.
- Finally, it is possible to use ***text data from the clipboard*** for plotting.
- Data file conversion from the command line is also available, which allows automatic (batch) processing.

In terms of data visualization and processing, Geomag data drawer provides the following main features:
- Construction of diagrams according to the presented data.
- Generation of data for plotting curves from an analytically given function.
- Editing diagram data in the built-in editor.
- Saving data files in Windows CSV format and as raw tabular data.
- Customization of most of the graphic characteristics of diagrams: sizes, placement, colors, fonts, lines, markers, etc.
- Setting your own coordinate plane and independent use of data columns as abscissas and ordinates for each dependence under study.
- Adding additional graphic objects: text labels, rectangles, ellipses and lines.
- Saving diagrams in graphic format `.png` with the ability to set a sufficiently large output size.
This allows you to overcome the limitations of raster graphics when further using the image.
- Saving diagrams in vector formats `.svg` version 1.1 and `.emf`, if it is necessary to avoid losses
when inserting an image into a printed document, or additional editing of the generated diagram in a vector graphics editor is required.

Implementation as a standalone application, support for all basic features for editing, building and designing diagrams, flexible
settings system, bilingual interface, as well as the ability to store data in its own format eliminates the need to install additional
software systems. Therefore, ***Geomag data drawer*** can be considered a very useful tool for processing and visualizing tabular data.

[:arrow_double_up:](#contents)

---

# 2. Main app interface

:warning: ***Translation is in progress*** :warning:

The main window of the app is shown in the figure below.

<img src="/GeomagDataDrawer/img/2_01.png" />

The main elements of the window:
- The diagram display field.
- List field of added curves and objects (selection of an arbitrary set of points for simultaneous adjustment is available; see below).
- Buttons for adding (<img src="/GeomagDataDrawer/img/2_70.png" vertical-align:middle />)
and deleting (<img src="/GeomagDataDrawer/img/2_73.png" vertical-align:-12px />) curves and additional objects.
- Buttons for hide/show (<img src="/GeomagDataDrawer/img/2_60.png" />) and select (<img src="/GeomagDataDrawer/img/2_61.png" />) curves and objects.
- Diagram options panel, which allows you to customize your own display settings for selected curves and objects. Namely:
    - in what range of abscissas and ordinates should the curve be drawn, and whether transposition is required (tab <img src="/GeomagDataDrawer/img/2_33.png" />);
    - how to position the image of curve and/or object on the sheet, and what size it should be (tab <img src="/GeomagDataDrawer/img/2_34.png" />);
    - whether it is necessary to manually set the location of the diagram captions and the title of the figure, or the app should set them automatically (tab <img src="/GeomagDataDrawer/img/2_36.png" />);
    - how to display the coordinate axes of the diagram (tab <img src="/GeomagDataDrawer/img/2_46.png" />);
    - how to display the coordinate grid of the diagram (tab <img src="/GeomagDataDrawer/img/2_47.png" />);
    - how to display diagram labels (tab <img src="/GeomagDataDrawer/img/2_48.png" />);
    - how to display the lines of curves on the diagram (tab <img src="/GeomagDataDrawer/img/2_49.png" />);
- App menu (see section “[App menu](#app-menu)”).

The main window of the app during operation is shown in the figure below:

<img src="/GeomagDataDrawer/img/2_02.png" />

Все изменения, выполняемые пользователем в поле параметров диаграммы, немедленно отражаются на диаграмме применительно к тем кривым
и графическим объектам, которые помечены в списке кривых и объектов и выделены серым цветом в поле диаграммы. Набор редактируемых
кривых и объектов может быть произвольным. Добавление в группу редактируемых выполняется аналогично выделению группы файлов
в Проводнике Windows, т.е. с помощью клавиш `[Ctrl]` и `[Shift]`. Таким образом, пользователь может производить тонкую
настройку параметров быстро и эффективно.

Каждый элемент управления в поле параметров, вкладки, а также пункты меню программы снабжены подсказками; для их вызова достаточно
задержать курсор над любым элементом на две секунды; при отсутствии движения подсказка отображается в течение 30 секунд.

Программа поддерживает функцию операционной системы *«Открыть с помощью»*. В случае успешной загрузки программа сразу приступает
к работе с указанным файлом.

Предусмотрена также возможность *автоматического построения кривых при загрузке файла* (если позволяет его содержимое).
Для этого программа создаёт файл стандартного шаблона `GeomagDataDrawer.txt` (если его ещё нет), аналогичный тому, который используется в функции
[параметрического добавления кривых](#section-26). Пользователь может изменять его по своему усмотрению, создавая различные стили предпросмотра.
Это позволяет ускорить поиск нужного файла данных, ориентируясь на изображение диаграммы, а не на её табличное
представление (аналогично просмотру фотографий).

В программе доступна возможность *движения по области построения*. Для этого можно воспользоваться полосами прокрутки, а также мышью.
В последнем случае необходимо щёлкнуть левой кнопкой мыши в любой части области построения и сдвинуть указатель в том направлении,
в котором требуется сдвинуть диаграмму, после чего отпустить кнопку (аналогично движению руки при перемещении большого листа бумаги).

Размер области построения, и, соответственно, размер сохраняемого изображения диаграммы определяется расположением изображений
кривых и объектов; её правый нижний угол совпадает с правым нижним углом крайнего изображения кривой. Соответственно, для увеличения
области построения необходимо переместить это изображение далее вправо и/или вниз.

Наконец, если работа над диаграммой не была завершена, все данные и настройки могут быть сохранены в собственный формат файлов программы,
после чего восстановлены при следующем запуске. Данная функция дублируется *функцией автосохранения (при закрытии) и автовосстановления
(при открытии)* состояния программы.

[:arrow_double_up:](#contents)

---

## 2.1. Добавление кривой или объекта на диаграмму

Чтобы добавить новую кривую или графический объект на диаграмму, необходимо нажать кнопку
<img src="/GeomagDataDrawer/img/2_70.png" /> рядом со списком кривых
и объектов. С версии 4.11 для этой функции доступна горячая клавиша, see section “[App menu](#app-menu)” of this guide.
При этом будет вызвано окно параметров добавления.

![image020](https://user-images.githubusercontent.com/20893717/147865987-5001624f-7d18-4a1d-bff4-2eac4a29cef7.png)

При добавлении кривой потребуется указать, какой столбец из загруженного файла данных будет столбцом абсцисс, а какой – столбцом ординат.
При добавлении объекта потребуется выбрать его тип (в текущей версии – линия (4 вида), прямоугольник, эллипс или текстовая подпись).
Количество кривых и объектов на диаграмме не должно превосходить максимально допустимое (см. раздел [«Ограничения и стандартные значения
параметров»](#section-48) данного руководства).

[:arrow_double_up:](#contents)

---

## 2.2. Удаление кривых и объектов с диаграммы

С помощью кнопки <img src="/GeomagDataDrawer/img/2_73.png" /> можно
удалить кривые и/или объекты с диаграммы. При этом потребуется подтверждение пользователя. Пользователь может выбрать несколько кривых
и объектов в списке для одновременного удаления. С версии 4.11 для этой функции доступна горячая клавиша; see section “[App menu](#app-menu)”
of this guide.

[:arrow_double_up:](#contents)

---

## 2.3. Скрытие / отображение кривых и объектов

С помощью кнопки <img src="/GeomagDataDrawer/img/2_60.png" /> пользователь
может временно скрывать выделенные кривые и объекты (кнопка при этом будет «отпущена»). При необходимости они могут быть снова отображены
в любой момент (кнопка будет «нажата»).

[:arrow_double_up:](#contents)

---

## 2.4. Выделение кривых и объектов

Кнопка <img src="/GeomagDataDrawer/img/2_61.png" /> позволяет выделить кривые
и объекты для настройки с помощью мыши. Для этого необходимо нажать кнопку и в поле построения диаграммы мышью выделить зону, в которой находятся
требуемые кривые и объекты. Все элементы диаграммы, затронутые прямоугольной областью выделения, будут выделены в списке добавленных кривых
и объектов. Кнопка выбора при этом вернётся в неактивное состояние.

[:arrow_double_up:](#contents)

---

## 2.5. Выбор диапазона построения кривой или линии
> *Параметры этой и всех последующих вкладок применяются ко всем кривым, выбранным (выделенным) в списке кривых.
> Часть функций будет недоступна при работе с графическими объектами*

Содержимое вкладки представлено на рисунке ниже.

![image050](https://user-images.githubusercontent.com/20893717/147866150-fa42a4d3-1bae-4269-b9fc-2ee18a236237.png)

Диапазоны построения вычисляются автоматически при загрузке каждой кривой в соответствии с её реальными границами. Причём, границы округляются
до первой слева значащей цифры. Несмотря на это, они могут быть изменены пользователем вручную по своему усмотрению. Из этой вкладки доступно
также транспонирование кривой, т.е. обмен абсцисс с ординатами местами.

Следует отметить, что границы диапазонов не обязаны соблюдать правило «*max ≥ min*». В частности, координатная плоскость может быть «отражена»
по горизонтали, по вертикали или по обоим направлениям сразу. Это можно сделать как вручную, так и с помощью кнопок
![image037](https://user-images.githubusercontent.com/20893717/147866171-34e1412f-b799-487f-bbd2-9e5f3841bada.png) и
![image038](https://user-images.githubusercontent.com/20893717/147866178-eb9d47b0-76f6-4acc-8e47-c26bfa504d96.png), что будет соответствовать
развороту осей абсцисс и ординат, соответственно. При этом опция транспонирования остаётся доступной. Всё это позволяет повысить гибкость
и информативность диаграммы в зависимости от потребностей конкретного исследования.

[:arrow_double_up:](#contents)

---

## 2.6. Задание расположения и размера изображения кривой или объекта

Содержимое вкладки представлено на рисунке ниже.

![image051](https://user-images.githubusercontent.com/20893717/147866262-cff5e3a1-b035-4d3f-994e-d0b9c2e9e26b.png)

Размер изображения отдельной кривой или объекта и его смещение ограничены максимальным размером листа (см. раздел [«Ограничения
и стандартные значения параметров»](#section-48) данного руководства). Но благодаря возможности
перемещения по области построения и достаточно большому её размеру программа позволяет строить и размещать требуемым образом большое
количество кривых на диаграмме.

С помощью соответствующих кнопок можно расположить выбранные кривые и объекты в ряд или в столбец. При этом программа автоматически
рассчитает соответствующие координаты для выбранных изображений.

В программе также есть возможность задания расположения изображения каждого элемента диаграммы с помощью мыши:
- По *двойному щелчку левой кнопки мыши* на поле диаграммы текущие выбранные изображения смещаются таким образом, что их верхние левые
углы устанавливаются на место щелчка.
- По *двойному щелчку правой кнопки мыши* изображения изменяют размеры так, чтобы их нижние правые углы оказались в месте щелчка.
- При *зажатой клавише* `[Ctrl]` *двойной щелчок левой кнопкой мыши* задаёт новое местоположение подписи рисунка.
- *Двойной щелчок правой кнопкой при зажатой клавише* `[Ctrl]` устанавливает подписи осей диаграммы таким образом, чтобы они
визуально пересекались в точке, в которой был выполнен щелчок.

Новые значения параметров передаются в соответствующие поля настроек диаграммы. Следовательно, ограничения на данную функцию накладываются
те же, что и на соответствующие поля.

Применительно к графическим объектам поля смещений определяют их расположение на диаграмме, а поля размеров задают величину прямоугольников,
эллипсов и полей отображения линий. Размеры полей для текстовых подписей рассчитываются автоматически.

[:arrow_double_up:](#contents)

---

## 2.7. Настройка подписей изображения кривой

Содержимое вкладки представлено на рисунке ниже.

![image053](https://user-images.githubusercontent.com/20893717/147866380-11bf648a-9c99-430f-86aa-7a8daa944ca8.png)

При выборе *автоматического задания подписей* и их расположения все остальные поля становятся недоступными, а соответствующие параметры
рассчитываются программой автоматически. Подписи осей размещаются рядом с осями внутри координатной плоскости; подписи изображений располагаются
так, чтобы при наложении нескольких кривых они находились в одной строке с пробелами между ними. Сама подпись, равно как и название кривой
в списке берётся либо из файла данных, либо формируется программой путём порядковой нумерации.

При выборе *ручного задания подписей* в поля параметров подставляются значения, вычисленные программой. В дальнейшем они ограничены только
размером изображения кривой. Заметим, что поле подписи диаграммы в этой вкладке применяется только к первой из выделенных кривых, если их выбрано несколько.

Применительно к графическому объекту «Текстовая строка» поле подписи задаёт собственно текст строки. Поведение объекта при этом не зависит
от состояния флажка «Автоопределение».

[:arrow_double_up:](#contents)

---

## 2.8. Настройка координатных осей изображения кривой

Содержимое вкладки представлено на рисунке ниже.

![image054](https://user-images.githubusercontent.com/20893717/147866573-7f501125-ca3e-43c2-a54b-baa6e0e7546a.png)

С помощью соответствующих полей можно настроить число основных и дополнительных делений на осях диаграммы, толщину осей в пикселях, а также их цвет
и относительное расположение, указать формат отображения чисел на шкалах (обычный или экспоненциальный). Возможен выбор автоопределения для числа делений;
в этом случае число засечек выбирается как наиболее подходящее для заданного диапазона построения.

Все параметры (здесь и далее) имеют допустимые диапазоны; ознакомиться с ними можно в разделе
[«Ограничения и стандартные значения параметров»](#section-48) данного руководства.
Цвет осей настраивается нажатием на цветную кнопку рядом с соответствующей надписью. Кнопка имеет цвет, соответствующий последнему выбранному цвету осей.

Оси могут быть принудительно установлены слева (сверху), по центру (посередине) или снизу (справа), или их расположение может быть определено автоматически.
В последнем случае программа установит ось в пересечение с нулём другой оси или выровняет её по той стороне, к которой ноль окажется ближе.

Кнопка «×» здесь и далее предназначена для отключения отображения того или иного элемента. Это, на самом деле, означает задание для него белого цвета,
который интерпретируется программой как прозрачный и не отображается при перерисовке. Указание белого цвета для осей, сетки и подписей будет иметь тот же эффект.

[:arrow_double_up:](#contents)

---

## 2.9. Настройка сетки изображения кривой

Содержимое вкладки представлено на рисунке ниже.

![image055](https://user-images.githubusercontent.com/20893717/147866639-767b6726-6d5e-4e09-8126-1ca7e2454449.png)

С помощью соответствующих полей можно настроить толщину линий сетки, а также цвета основных и дополнительных линий. Цвета линий сетки по умолчанию
совпадают с фоном (белый), поэтому сетка не видна. При «включении» сетки её линии отстраиваются в соответствии с расположением засечек на осях.
Кнопка «×» или установка белого цвета линий скрывает сетку.

[:arrow_double_up:](#contents)

---

## 2.10. Настройка шрифтов и цветов подписей изображения

Содержимое вкладки представлено на рисунке ниже.

![image056](https://user-images.githubusercontent.com/20893717/147866681-69bf6f30-1ce2-46a2-b3fa-69d893784e4e.png)

Вкладка позволяет настроить стиль отображения подписи изображения и подписей осей кривой или графического объекта «Текстовая строка».
Кнопки выбора шрифтов вызывают стандартное окно выбора шрифта, его кегля и стиля. Цветные кнопки позволяют задать цвета подписей.

![image013](https://user-images.githubusercontent.com/20893717/147866695-566c75c5-877e-4d48-a674-73112e11f8a5.png)

Программа не допускает использование некоторых шрифтов. Если пользователь выбирает неподходящий шрифт, программа извещает его об этом
и предлагает выбрать другой. Установка белого цвета подписей отключает их.

[:arrow_double_up:](#contents)

---

## 2.11. Настройка стиля линии кривой

Содержимое вкладки представлено на рисунке ниже.

![image057](https://user-images.githubusercontent.com/20893717/147866709-00b5c268-efb9-4c5f-8bd7-c485d39503b0.png)

Вкладка позволяет настроить толщину линии кривой или графического объекта «Линия», её цвет и стиль отображения, а также используемый маркер.
Под стилем понимается один из трёх вариантов представления кривой:
- «Только линия» – указывает на отображение линии без маркеров;
- «Линия и маркеры» – указывает на отображение линии с маркерами;
- «Только маркеры» – указывает на отображение только маркеров в опорных точках кривой.

Если стиль предполагает отображение маркеров, поле выбора маркера становится доступным; в противном случае оно блокируется.
Список доступных маркеров состоит из двух частей:
- Стандартные маркеры, формируемые программой. Доступны под номерами 1 (квадратик), 2 (кружочек), 3 (треугольник), 4 (пустой прямоугольник), 5 (кольцо) и 6 (крестик).
- Дополнительные маркеры.

Дополнительные маркеры получаются программой из изображений в формате `.png`, хранящихся в директории `Markers`, находящейся в одной
директории с программой. Если данной директории не существует, программа автоматически её создаёт. Если в директории есть изображения в формате `.png`,
программа загружает в качестве маркеров только те из них, которые доступны, не повреждены и имеют подходящий размер (см. раздел [«Ограничения
и стандартные значения параметров»](#section-48) данного руководства). Успешно загруженные маркеры доступны
под номерами 7, 8 и далее.

Следует отменить, что программа особым образом преобразует загружаемые изображения. А точнее:
- Белый (`#FFFFFF`) цвет или белый прозрачный цвет (`#00FFFFFF`) заменяется белым прозрачным цветом;
- Все остальные цвета заменяются выбранным цветом кривой.

Эта функция позволяет использовать в качестве маркеров практически любые изображения без особых изменений. В стандартную комплектацию
программы дополнительные маркеры не входят.

[:arrow_double_up:](#contents)

---

# 3. App menu

Главное меню программы представлено пунктами, описанными ниже. В скобках указаны «горячие клавиши», с помощью которых можно вызвать соответствующее меню.
Выделенные буквы можно использовать для быстрого вызова функции с нажатой клавишей `[Alt]`.
- Файл; включает подменю:
    - Открыть файл данных (`[Ctrl]` + `[O]`);
    - Загрузить из буфера обмена (`[Ctrl]` + `[V]`);
    - Сохранить файл данных (`[Ctrl]` + `[S]`);
    - Сохранить диаграмму (`[Ctrl]` + `[I]`);
    - Закрыть диаграмму (`[Ctrl]` + `[W]`);
    - Сгенерировать кривые (`[Ctrl]` + `[G]`);
    - Настройки программы (`[Ctrl]` + `[P]`);
    - Выход (`[Ctrl]` + `[Q]`).
- Операции; включает подменю:
    - Добавить кривую или объект (`[F5]`);
    - Параметрическое добавление кривых (`[Ctrl]` + `[F5]`);
    - Выбор столбцов данных кривой (`[F6]`);
    - Совместить кривые или объекты (`[F7]`);
    - Удалить кривые или объекты (`[F8]`);
    - Редактировать данные диаграммы (`[Ctrl]` + `[E]`);
    - Загрузить стиль (`[F11]`);
    - Сохранить стиль (`[F12]`);
    - Сбросить стиль (`[F9]`);
    - Сохранить шаблон добавления кривых (`[Ctrl]` + `[T]`).
- Помощь; включает подменю:
    - О программе / справка (`[F1]`);
    - Выбор языка интерфейса (список).
    - Ассоциировать файлы.

[:arrow_double_up:](#contents)

---

## 3.1. «Файл»

## 3.1.1. «Открыть файл данных»

Вызывает стандартное окно открытия файла. Возможность добавления кривых и объектов появляется сразу после подтверждения выбора файла данных,
если он доступен и имеет корректный формат. Если же при загрузке возникла ошибка, пользователь получает соответствующее сообщение, а программа
вновь отображает последнюю успешно загруженную диаграмму.

> ***Все несохранённые данные при этом теряются, если пользователь соглашается с соответствующим предупреждением.***

Если пользователь выбрал файл данных Geomag data drawer (`.gdd`), в котором уже содержались настройки отображения кривых и графических
объектов, в поле диаграммы будет отображено последнее их состояние. Если используется шаблон для автоматического добавления кривых на диаграмму,
при загрузке файла данных они также будут отображены. Во всех остальных случаях работа начинается с пустого поля диаграммы. Но в любом случае файл
должен содержать не менее двух строк и не менее двух столбцов данных.

В программе явно задано максимально допустимое количество столбцов и строк данных (см. раздел
[«Ограничения и стандартные значения параметров»](#section-48)
данного руководства). Столбцы и строки данных, выходящие за допустимый диапазон, игнорируются при загрузке.

При выборе опции извлечения данных из произвольного файла пользователю потребуется сначала указать предполагаемое количество столбцов данных.

![image022](https://user-images.githubusercontent.com/20893717/147868607-2b928c9a-cf8d-44b8-a344-f3fe21ec2620.png)

Это значение может быть указано «с запасом», если точное число столбцов неизвестно. Все недостающие значения будут заменены нулями. Более
подробные сведения об извлечении данных содержатся в разделе [«Спецификации форматов файлов»](#section-49) данного руководства.

При открытии любого файла (кроме `.gdd`) пользователю также потребуется указать количество строк файла, которое будет использоваться
для поиска имён столбцов данных.

![image080](https://user-images.githubusercontent.com/20893717/147868744-b8245037-1d2a-4808-bac9-113afbf7d3cf.png)

Заданное количество строк будет рассматриваться программой именно как набор текста: данные из этих строк будут проигнорированы. Данное значение
нужно указывать точно, т.к. меньшее значение будет вызывать ошибку (текст окажется там, где должны быть данные), а большее значение приведёт
к потере части данных и некорректному отображению имён столбцов.

Извлечённые из файла данных подписи столбцов данных используются для обозначения и подписывания кривых в программе. Если подписи считать
не удалось (в частности, если количество предполагаемых столбцов при извлечении данных оказалось больше или меньше реального числа столбцов),
программа именует их в порядке считывания: с.1, с.2 и т.д.

[:arrow_double_up:](#contents)

---

## 3.1.2. «Загрузить из буфера обмена»

Пункт меню позволяет использовать текстовые данные в буфере обмена, скопированные из другой программы, для построения диаграммы.
При этом пользователю будет предложено указать ожидаемое количество столбцов и количество строк для поиска имён столбцов.

> ***Все несохранённые данные при этом теряются, если пользователь соглашается с соответствующим предупреждением.***

[:arrow_double_up:](#contents)

---

## 3.1.3. «Сохранить файл данных»

Программа может сохранять загруженные данные в файлы всех типов, которые поддерживает (кроме `.xls` и `.xlsx`). Если сохранение произошло
с ошибкой, пользователь извещается об этом. Названия столбцов данных также могут быть сохранены, если соответствующая опция выбрана в настройках
программы. Следует отметить, что сохранение графических объектов возможно только в собственном формате программы.

[:arrow_double_up:](#contents)

---

## 3.1.4. «Сохранить диаграмму»

Вызывает окно вариантов формирования конечного изображения диаграммы.

![image015](https://user-images.githubusercontent.com/20893717/147868885-7397ad58-6633-4f70-91d3-f680b25846b1.png)

Пользователю предлагаются следующие варианты сохранения:
- *Сохранить видимый макет*. В этом случае изображение сохраняется в том виде и размере, в котором оно отображается в главном окне программы.
При этом можно увеличить масштаб изображения, если необходимо, например, повысить его качество. Ограничения величины масштаба можно найти
в разделе [«Ограничения и стандартные значения параметров»](#section-48) данного руководства. Формат файла – `.png`.
- *Подогнать макет*. Данная группа вариантов позволяет сохранять изображения в пропорциях форматов бумаги A3 и A4. При этом отображаемое
в главном окне изображение располагается в верхнем левом углу будущего листа бумаги, а его размер пересчитывается таким образом, чтобы оно
максимально заполнило лист с учётом его расположения и размера. Незаполненная часть листа остаётся пустой. Заметим, что пересчёт изображения
выполняется в качестве 300 dpi, что обеспечивает приемлемое качество печати на чёрно-белом и цветном принтере. Формат файла – `.png`.
- *Сохранить как векторное изображение*. Этот вариант позволяет сохранять изображения в векторных форматах `.svg` и `.emf`. Подходит
для выполнения более тонких модификаций изображения диаграммы, а также в других случаях, когда растровое изображение неприемлемо
(например, при позиционировании изображения в тексте печатного документа). Элементы рисунка группируются таким образом, чтобы минимизировать
время, необходимое на ручную коррекцию диаграммы.

Кнопка «Сохранить» вызывает стандартное окно сохранения; кнопка «Отмена» прерывает операцию.

[:arrow_double_up:](#contents)

---

## 3.1.5. «Закрыть диаграмму»

Меню закрывает текущую диаграмму и возвращает программу в начальное состояние. Поля настроек и пункты меню, связанные с сохранением, блокируются.

> ***Все несохранённые данные при этом теряются, если пользователь соглашается с соответствующим предупреждением.***

[:arrow_double_up:](#contents)

---

## 3.1.6. «Сгенерировать кривые»

Вызывает окно, позволяющее задать аналитические функции и диапазон генерации данных.

![image081](https://user-images.githubusercontent.com/20893717/147869357-a560690c-c492-4073-9ceb-a9e2f2b35661.png)

Пользователь может задать функции, табличное представление которых требуется рассчитать, и указать диапазон построения. В случае обнаружения ошибок
при составлении функции пояснительные сообщения отображаются под полем ввода функции. Проверка корректности задания функции выполняется по нажатию
кнопки «+» или клавиши [Enter]; функция при этом добавляется в список проверенных функций. Количество добавляемых кривых ограничено (см. раздел
[«Ограничения и стандартные значения параметров»](#section-48) данного руководства). Корректность диапазона
проверяется при нажатии кнопки «ОК».

Кнопка «ОК» запускает генерацию и передаёт данные на отрисовку в главное окно программы. После этого становятся доступны все основные функции меню.
Кнопка «Отмена» возвращает программу в исходное состояние.

> ***Все несохранённые данные при этом теряются, если пользователь соглашается с соответствующим предупреждением.***

[:arrow_double_up:](#contents)

---

## 3.1.7. «Настройки программы»

Вызывает окно настроек программы.

![image017](https://user-images.githubusercontent.com/20893717/147869561-82181086-9a87-410a-adff-bcb0d0a326b2.png)

Пользователь может:
- Установить обязательный запрос на завершение работы с программой. Если эта опция отключена, выход из программы может быть произведён,
в том числе – случайным закрытием главного окна, что может привести к потере важных данных (если не установлена следующая опция).
- Включить функцию автоматического восстановления состояния программы. Если она включена, последние загруженные данные и отображаемые кривые будут
восстановлены программой в том же виде при следующем запуске.
- Включить функцию автоматического добавления кривых на диаграмму при загрузке файла данных (см. раздел
[«Главный интерфейс программы»](#section-2) данного руководства).
- Включить функцию сохранения названий столбцов данных в файлах данных текстовых форматов.
- Отключить функцию позиционирования диаграмм мышью. Рекомендуется при работе на планшетных ПК во избежание конфликтов жестов.

Кнопка «Сохранить» вызывает обновление конфигурации программы; кнопка «Отмена» позволяет покинуть окно настроек без их изменения.

[:arrow_double_up:](#contents)

---

## 3.1.8. «Выход»

Позволяет завершить работу с программой. В зависимости от настроек, завершение работы может сопровождаться сохранением состояния диаграммы и запросом
на выход из приложения. При этом программа сохраняет размеры и положение главного окна; они восстанавливаются при следующем запуске.

> ***Все несохранённые данные при этом теряются, если пользователь соглашается с соответствующим предупреждением.***

[:arrow_double_up:](#contents)

---

## 3.2. «Операции»

## 3.2.1. «Добавить кривую или объект»

Пункт меню выполняет функции, аналогичные описанным в [пункте 2.1](#section-3) данного руководства.

[:arrow_double_up:](#contents)

---

## 3.2.2. «Параметрическое добавление кривых»

Если необходимо быстро добавить несколько однотипных диаграмм и также быстро расположить их на листе, можно воспользоваться параметрическим
добавлением кривых. С помощью соответствующего диалогового окна можно задать номера столбцов данных, размеры каждого изображения и его положение,
а также подпись к нему.

![image021](https://user-images.githubusercontent.com/20893717/147869713-de608939-1905-4e37-96d0-aca05e7b1943.png)

Если требуется добавить несколько диаграмм за один раз, можно воспользоваться опцией загрузки параметров из файла. С этой
целью пользователь может создать текстовый документ, строки которого сформированы по правилам, указанным в диалоговом окне, и загрузить его, нажав
кнопку «Файл». Кроме того, файл, подходящий для этой функции, может быть создан с помощью соответствующего пункта меню.

[:arrow_double_up:](#contents)

---

## 3.2.3. «Выбор столбцов данных кривой»

Пункт меню позволяет изменить столбцы данных, использованные при построении выбранной кривой. При этом будет вызвано окно, аналогичное тому, которое
вызывается при простом добавлении кривой. Здесь потребуется указать, какой столбец из файла данных будет новым столбцом абсцисс, а какой – столбцом
ординат в выбранной зависимости. Данная опция может быть полезна в случае, если требуется быстро построить новую кривую на месте имеющейся,
используя настройки стиля и расположение последней.

[:arrow_double_up:](#contents)

---

## 3.2.4. «Совместить кривые или объекты»

Пункт меню позволяет совместить две кривые, т.е. расположить их друг над другом и опционально задать общие оси. Функция требует, чтобы перед
её вызовом были выделены ровно две кривые; в противном случае совмещение выполнено не будет.

Окно параметров совмещения кривых представлено на рисунке ниже.

![image063](https://user-images.githubusercontent.com/20893717/147869889-1bf8e42c-f477-4abd-8fe7-b186be280f91.png)

Пользователь может указать, на месте какой из кривых следует расположить результат совмещения. Также можно выбрать, какая ось будет общей
для двух кривых, и следует ли установить цвет подписей осей и подписи кривой в цвет самой кривой для повышения наглядности диаграммы.

При совмещении общим осям кривых присваиваются одинаковые параметры (максимальное и минимальное значение, число засечек и расположение),
а разные оси разводятся по краям изображения кривой. Общими также становятся размеры изображений кривых, значение параметра транспонирования кривой
и параметры осей; размещение подписей кривых выполняется в автоматическом режиме.

Данная функция может быть применена и к графическим объектам, если это необходимо. Обратите внимание, что процедура не является необратимой,
т.к. всего лишь меняет расположение и стили отображения кривых на диаграмме.

[:arrow_double_up:](#contents)

---

## 3.2.5. «Удалить кривые или объекты»

Пункт меню выполняет функции, аналогичные описанным в [пункте 2.2](#section-4) данного руководства.

[:arrow_double_up:](#contents)

---

## 3.2.6. «Редактировать данные диаграммы»

Пункт меню вызывает окно редактирования данных диаграммы:

![image040](https://user-images.githubusercontent.com/20893717/147869954-ae07465f-d803-4a64-ac7d-239b27fc1f3b.png)

> ***Данная опция может работать медленно и при вызове на некоторое время замораживать интерфейс программы.
> Это связано с особенностями механизмов работы редактора и не является сбоем или ошибкой.***

Данные в таблице представлены в том виде, в котором они были получены из файла данных. Для редактирования каждого отдельного значения достаточно выделить
соответствующую ячейку и начать клавишу `[F2]` либо дважды щёлкнуть её. Дробные значения должны вводиться с десятичным разделителем, указанным
в настройках ОС. Обо всех ошибках при заполнении ячеек таблицы пользователь извещается или сразу при попытке покинуть ячейку, или при попытке
сохранить внесённые изменения.

Доступно также редактирование имён столбцов данных. Для этого достаточно дважды щёлкнуть по заголовку столбца, название которого требуется изменить.

Для самой таблицы доступны следующие операции:
- Перемещение текущей выбранной строки на одну позицию вверх (кнопка
![image041](https://user-images.githubusercontent.com/20893717/147870027-ca60fb71-6be0-42c2-b173-64889eda63fd.png)).
В качестве текущей здесь и далее выступает последняя выделенная строка;
- Перемещение текущей выбранной строки на одну позицию вниз (кнопка
![image042](https://user-images.githubusercontent.com/20893717/147870034-8aaaf99a-2bd1-4065-a073-1658267f35f0.png));
- Добавление строки перед текущей выбранной (кнопка
![image043](https://user-images.githubusercontent.com/20893717/147870039-c363440c-acad-4f33-9157-867ca20e7d92.png));
- Добавление строки после текущей выбранной (кнопка
![image044](https://user-images.githubusercontent.com/20893717/147870051-fb300b87-8d6d-4661-b8df-dda21a72f0e1.png));
- Удаление выбранных строк (кнопка
![image045](https://user-images.githubusercontent.com/20893717/147870055-a2c9c3ff-c394-4ff8-ac07-b00867e873e3.png)).
Удаляются все затронутые выделением строки. То, как при этом выделены столбцы, не имеет значения.

Кнопка «Сохранить изменения» в случае их корректности применяет внесённые изменения к данным диаграммы и инициирует её перерисовку.
Кнопка «Отменить изменения» возвращает диаграмму в исходное состояние.

[:arrow_double_up:](#contents)

---

## 3.2.7. «Загрузить стиль»

Вызывает стандартное окно открытия файла, позволяющее выбрать необходимый стиль отображения выбранных кривых и объектов. Если файл стиля `.gds`
не доступен, его загрузка не выполняется; если файл повреждён, его загрузка выполняется настолько, насколько это возможно.

Далее пользователю предлагается выбрать, каким образом следует интерпретировать загруженный стиль:
- *Применить к выделенным кривым и объектам*. В этом случае номера столбцов данных, сохранённые в файле стиля, игнорируются, а стиль
применяется ко всем выделенным кривым и объектам в порядке прямой нумерации.
- *Добавить на диаграмму кривые, заявленные в файле стиля*. В этом случае, если указанные в файле стиля столбцы данных доступны, будут добавлены
соответствующие кривые, и уже к ним будут применены содержащиеся в файле стили.

В стандартную комплектацию программы файлы стилей не входят.

[:arrow_double_up:](#contents)

---

## 3.2.8. «Сохранить стиль»

Вызывает стандартное окно сохранения файла, позволяющее выбрать необходимое местоположение и имя для нового файла стиля. В файл сохраняются
все параметры в том состоянии, в котором они находились на момент выбора данного пункта меню? применительно ко всем выбранным в данный момент
кривым и объектам. Это позволяет создавать как стили отображения отдельных зависимостей, так и стили для представления групп файлов данных
одинакового формата.

[:arrow_double_up:](#contents)

---

## 3.2.9. «Сбросить стиль»

Пункт меню возвращает все параметры стиля всех выбранных кривых и объектов, кроме границ построения, на стандартные значения (см. раздел
[«Ограничения и стандартные значения параметров»](#section-48) данного руководства).

[:arrow_double_up:](#contents)

---

## 3.2.10. «Сохранить шаблон добавления кривых»

Позволяет сохранить шаблон добавления кривых на диаграмму, который затем может быть использован в функции параметрического добавления кривых.
В файл записываются базовые параметры для всех кривых, добавленных на диаграмму к моменту вызова функции.

[:arrow_double_up:](#contents)

---

## 3.3. «Помощь»

## 3.3.1. «О программе / справка»

Пункт меню позволяет вызвать данное руководство пользователя, а также получить доступ к другим проектам
и ресурсам Лаборатории.

[:arrow_double_up:](#contents)

---

## 3.3.2. Пункт меню с выбором языка интерфейса

Пункт меню позволяет выбрать язык подписей и подсказок интерфейса программы. Язык меняется сразу, без перезапуска программы, после чего сохраняется
в конфигурации приложения.

В текущей версии доступны следующие языки:
- Русский (Россия);
- Английский (США).

[:arrow_double_up:](#contents)

---

## 3.3.3. «Ассоциировать файлы»

Пункт меню позволяет закрепить приложение в качестве стандартного для открытия файлов `.gdd` и заблокировать от ручного редактирования
файлы стилей `.gds`. Благодаря этому файлы диаграмм можно открывать двойным щелчком, без отдельного входа в приложение.

[:arrow_double_up:](#contents)

---

## 3.4. «Дополнительно»

## 3.4.1. «Соединить таблицы»

Эта функция позволяет объединять таблицы данных различных типов в единый файл. Например, если имеются следующие файлы:

```
  A B
1 1 1
2 4 5
3 6 7

  C D E
1 8 9 4
3 2 3 2
```

на их основе можно получить следующие итоговые таблицы: без восстановления пропусков

```
  A B C D E
1 1 1 8 9 4
3 6 7 2 3 2
```
и с восстановлением пропусков

```
  A B C D E
1 1 1 8 9 4
2 4 5 0 0 0
3 6 7 2 3 2
```
Результат будет зависет от выбранных настроек.

[:arrow_double_up:](#contents)

---

## 3.4.2. «Создать векторный рисунок»

Этот инструмент позволяет генерировать векторное изображение (`SVG` или `EMF`), используя файл скрипта
с настраиваемыми параметрами кривых, осей и текстовых меток. С описанием формата скрипта можно ознакомиться
[здесь](https://github.com/adslbarxatov/GeomagDataDrawer/tree/master/VIGScripts) или путём сохранения
образца из окна данной функции.

[:arrow_double_up:](#contents)

---

# 4. Аппаратно-программные требования и комплектация программы

## 4.1. Комплектация программы

В стандартную комплектацию программы входят следующие файлы:
- `GeomagDataDrawer.exe` – исполняемый модуль программы;
- `ExcelDataReader.dll`, `ExcelDataReader.DataSet.dll`, `ICSharpCode.SharpZipLib.dll` – файлы библиотек, обеспечивающих поддержку формата
данных Microsoft Office Excel. Приложение может функционировать без поддержки этого формата.

[:arrow_double_up:](#contents)

---

## 4.2. Создаваемые файлы и директории

Программа может создавать следующие файлы и директории:
- `.gds` – файлы стилей отдельных кривых диаграммы;
- `.png`, `.svg`, `.emf` – файлы изображений диаграмм;
- `.gdd`, `*.*`, `.csv` – файлы данных, сохранённые программой;
- `Backup.gdd` – файл данных для автоматического восстановления состояния программы;
- `GeomagDataDrawer.txt` – файл шаблона отображения открываемых файлов данных, содержащий описание автоматически добавляемых кривых;
- `Markers` – директория для хранения дополнительных маркеров.

[:arrow_double_up:](#contents)

---

## 4.3. Поддерживаемые форматы данных

Программа поддерживает следующие форматы:
- `.xls`, `.xlsx` – файлы таблиц Microsoft Office Excel ’97 и ’07;
- `.csv` – файлы табличных данных;
- `*.*` – файлы произвольных табличных данных или текстовые файлы с доступными для извлечения данными;
- `.gdd` – файлы данных Geomag data drawer;
- `.png` – файлы изображений маркеров.

[:arrow_double_up:](#contents)

---

## 4.4. Поддержка форматов Microsoft Office Excel

Поддержка файлов таблиц Microsoft Office Excel ’97 и ’07 выполняется с помощью библиотеки ExcelDataReader версии 3.4 
(библиотеки `ExcelDataReader.dll`, `ExcelDataReader.DataSet.dll`) и вспомогательной библиотеки, предоставляющей функционал архивирования файлов
для поддержки формата MS Excel ’07 версии 0.86.0.518 (библиотека `ICSharpCode.SharpZipLib.dll`).

Обе библиотеки распространяются на основе лицензии МТИ (MIT license). Ниже приведён её текст ([оригинал](https://opensource.org/licenses/mit-license.php)).

> Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the «Software»), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:
> 1. The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.
> The software is provided «as is», without warranty of any kind, express or implied, including but not limited to the warranties of merchantability, fitness for a particular purpose and noninfringement. In no event shall the authors or copyright holders be liable for any claim, damages or other liability, whether in an action of contract, tort or otherwise, arising from, out of or in connection with the software or the use or other dealings in the software.

Перевод:

> Данная лицензия разрешает лицам, получившим копию данного программного обеспечения и сопутствующей документации (в дальнейшем именуемыми «Программное Обеспечение»), безвозмездно использовать Программное Обеспечение без ограничений, включая неограниченное право на использование, копирование, изменение, добавление, публикацию, распространение, сублицензирование и/или продажу копий Программного Обеспечения, а также лицам, которым предоставляется данное Программное Обеспечение, при соблюдении следующих условий:
> 1. Указанное выше уведомление об авторском праве и данные условия должны быть включены во все копии или значимые части данного Программного Обеспечения.
> Данное программное обеспечение предоставляется «как есть», без каких-либо гарантий, явно выраженных или подразумеваемых, включая гарантии товарной пригодности, соответствия по его конкретному назначению и отсутствия нарушений, но не ограничиваясь ими. Ни в каком случае авторы или правообладатели не несут ответственности по каким-либо искам, за ущерб или по иным требованиям, в том числе, при действии контракта, деликте или иной ситуации, возникшим из-за использования программного обеспечения или иных действий с программным обеспечением.

Комплект библиотек доступен [здесь](https://github.com/ExcelDataReader/ExcelDataReader). Код библиотек не включён в исполняемый файл (находится в библиотеках).
Библиотеки, включённые в комплектацию, не модифицировались при разработке приложения.

Включив текст лицензии MIT в файл справки, а также не использовав методы защиты исходного кода программы от реинжиниринга (код не обфусцирован и не упакован;
доступен для реинжиниринга с помощью бесплатных программных средств, что проверено на примере ILSpy; извлекаемый код информативен), считаем требования лицензий
библиотек, включённых в сборку, ***выполненными***.

[:arrow_double_up:](#contents)

---

## 4.5. Требования к установке программы

Обязательные требования к установке программы:
- Доступная оперативная память – не менее 256 Мб;
- Доступное дисковое пространство – не менее 20 Мб;
- Установленная среда .NET Framework версии 4.8.

Дополнительные требования к установке программы:
- Наличие свободного места для хранения изображений диаграмм и сохраняемых файлов данных;
- Наличие видеокарты, способной к достаточно быстрой обработке быстро сменяющихся изображений;
- Наличие процессора, способного к достаточно быстрой обработке объёмов данных, предоставляемых для построения диаграмм, и соответствующего объёма оперативной памяти;
- Наличие монитора, поддерживающего достаточно большое разрешение.

[:arrow_double_up:](#contents)

---

## 4.6. Работа с программой из командной строки

Варианты использования программы из командной строки:
- `GeomagDataDrawer` – запуск программы;
- `GeomagDataDrawer /?` – отображение сообщения с вариантами использования программы из командной строки;
- `GeomagDataDrawer <имя_файла>` – загрузка файла «имя_файла»;
- `GeomagDataDrawer <имя_файла> <имя_файла_2> [SLC] [ECC]` – преобразование файлов из первого формата во второй. В качестве конечных файлов
допускается указание поддерживаемых типов изображений; приложение будет опираться на указанные расширения файлов при преобразовании.
    - `[SLC]` – количество строк, используемых для поиска имён столбцов; если не указан, считывается из конфигурации приложения;
    - `[ECC]` – ожидаемое количество столбцов данных (для извлечения); если не указан, считывается из конфигурации приложения.

[:arrow_double_up:](#contents)

---

# 5. Ограничения и стандартные значения параметров

> Все значения указаны только в отношении данной версии программы. Звёздочкой помечены параметры, ограничения и значения которых
> пересчитываются с учётом масштаба при сохранении конечного изображения

| Параметр | Минимум | Максимум | Значение по умолчанию |
| -------- | ------- | -------- | --------------------- |
| Количество строк данных | 2 | 10001 | — |
| Количество столбцов данных | 2 | 100 | — |
| Количество кривых на диаграмме | 0 | 20 | — |
| Количество графических объектов на диаграмме | 0 | 50 | — |
| Число основных делений на оси Ox | 1 | 100 | Автоопределение |
| Число дополнительных делений на оси Ox | 1 | 10 | 2 |
| Число основных делений на оси Oy | 1 | 100 | Автоопределение |
| Число дополнительных делений на оси Oy | 1 | 10 | 2 |
| Толщина осей/засечек, px* | 1 | 10 | 1 |
| Цвет осей/засечек | — | — | Чёрный |
| Расположение оси Ox | — | — | Автоматически |
| Расположение оси Oy | — | — | Автоматически |
| Формат подписей оси Ox | — | — | Нормальный |
| Формат подписей оси Oy | — | — | Нормальный |
| Толщина линий сетки, px* | 1 | 10 | 1 |
| Цвет основных линий сетки | — | — | Белый (фон) |
| Цвет дополнительных линий сетки | — | — | Белый (фон) |
| Длина подписи кривой | 0 | 200 | — |
| Шрифт подписи кривой | — | — | Arial |
| Кегль подписи кривой* | 4 | 36 | 9 |
| Стиль подписи кривой | — | — | Обычный |
| Цвет подписи кривой | — | — | Чёрный |
| Шрифт подписей осей | — | — | Arial |
| Кегль подписей осей* | 4 | 36 | 8 |
| Стиль подписей осей | — | — | Обычный |
| Цвет подписей осей | — | — | Чёрный |
| Толщина кривых, px* | 1 | 10 | 1 |
| Стиль отображения кривой | — | — | Линия без маркеров |
| Маркер кривой | 1 | 6 + число успешно загруженных изображений маркеров | 1 (квадратик) |
| Размеры изображения дополнительного маркера, px | 3 × 3 | 17 × 17 | — |
| Размеры рисунка одной кривой, размер области диаграммы, размер сохраняемого изображения, px* | 100 × 100 | 10000 × 10000 | 500 × 500 |
| Смещение рисунка кривой от верхнего левого края изображения, px* | (0, 0) | (9900, 9900) | (0, 0) |
| Масштаб сохраняемого изображения | 1,0 | 10,0 | 1,0 |

[:arrow_double_up:](#contents)

---

# 6. Спецификации форматов файлов

## 6.1. Файлы данных Geomag data drawer

Спецификация формата `.gdd` на данный момент недоступна к публикации. Не рекомендуется самостоятельное внесение изменений в файлы
данных Geomag data drawer во избежание потерь данных.

[:arrow_double_up:](#contents)

---

## 6.2. Файлы данных в формате Microsoft Office Excel

В файле `.xls` или `.xlsx` должна храниться одна таблица. Пустые поля, пропуски и иные элементы будут замещены нулями.
Таблица должна располагаться на первом листе файла. Допускаются текстовые пояснения в первых строках файла. Допускается использование
формул без зависимостей, для разрешения которых необходим запуск Microsoft Office Excel. Допускается использование форматирования листа.

[:arrow_double_up:](#contents)

---

## 6.3. Файлы данных в формате Windows CSV

Требуется одинаковое количество числовых значений в строках файла `.csv`. Количество подписей должно совпадать с числом столбцов данных,
иначе они будут проигнорированы. Значения должны быть разделены точкой с запятой (`;`) в любых количествах, но не менее одного. Десятичным
признаком может быть точка (`.`) или запятая (`,`). При сохранении файла программа использует запятую. Допускается обычное
и экспоненциальное представление чисел с дробной частью и без неё (с символами `E` и `e`). Абзацы и посторонние символы будут замещены
нулевыми значениями. Используется кодовая страница Windows1251.

Пример содержимого файла в формате Windows CSV:

```
Ст.1;Ст.2;Ст.3
1;10;40,9
2;20,1;4.39e-01
3;0,9;4,33E-1
```

[:arrow_double_up:](#contents)

---

## 6.4. Файлы, из которых необходимо извлечь данные

Используется кодовая страница Windows1251. Символы `0` – `9`, `-`, латинские `e` и `E`, `.` и `,` считаются элементами
числовых значений. Все остальные символы используются в качестве разделителей. Наборы допустимых символов, которые не являются числами, интерпретируются
как нулевые значения. Нулевыми значениями замещаются также недостающие значения в строках, если при загрузке файла было задано число столбцов,
превышающее имеющееся в файле.

Если в строке нет числовых значений, она игнорируется. Если же в строке есть хоть один допустимый символ, она загружается программой. В связи с этим
перед загрузкой файла настоятельно рекомендуется удалить из него все строки, которые могут быть интерпретированы подобным образом, или воспользоваться
опцией поиска названий столбцов. В противном случае на диаграмме могут быть отображены некорректные (с точки зрения её смысла) показания, а диапазон
её построения, рассчитанный с учётом таких данных, может сильно отличаться от требуемого.

Пример содержимого файла и его интерпретации:

| Исходные данные | Данные после удаления разделителей | Результат |
| - | - | - |
| 1 10 40.9 | 1 10 40.9 | 1,0; 10,0; 40,9 |
| abcde1 1*0 40,9 | e1 1 0 40,9 | 0,0; 1,0; 0,0; 40,9 |
| -10 +40.9 -4,9e-1 | -10 40.9 -4,9e-1 | -10,0; 40,9; -0,49 |

[:arrow_double_up:](#contents)
